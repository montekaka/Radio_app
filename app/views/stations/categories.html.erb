<div data-role="page" id="CategoryPage">
	<div data-role="header" data-theme="b">
		<h1><%=@station.name%></h1>
		<%= link_to 'Back',stations_path, {"class"=>"ui-btn-left", "data-icon" => "back", "rel"=>'external'} %>
	</div>
	<div data-role="content">
		<ul data-role="listview" data-inset="true">
			<% @station.shows.select("DISTINCT(CATEGORY)").each do |c| %>
				<li data-role="list-divider">
					<%= c.category%>
				</li>				
				<% @station.shows.find_all_by_category(c.category).each do |show| %>
					<li>
						<% if show.audioposts.count > 0 %>
							<a href = '<%= show_audioposts_path(show)%>' rel='external'>
								<h2><%= show.name %></h2>
								<p><%= show.djname %></p>
								<span class='ui-li-count'>
									<%= show.audioposts.count %>
								</span>						
							</a>
						<%else%>
							<h2><%= show.name %></h2>
							<p><%= show.djname %></p>
							<span class='ui-li-count'>
								<%= show.audioposts.count %>
							</span>						
						<%end%>
					</li>
				<%end%>
			<% end %>			
		</ul>
	</div>
</div>
<script type="text/javascript">
    mixpanel.track("Station Page Loaded", {"Station Name": "<%= @station.name %>"}, function(){console.log('<%= @station.name %>')});  
</script>